<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta charset="utf-8"/>
	<title>yandexMapsTast</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    <script src="https://api-maps.yandex.ru/2.1/?apikey=454e4d69-408b-421e-9a9a-81252607a23e&lang=ru_RU" type="text/javascript"></script>
    <!-- <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script> -->
    <script type="text/javascript">
		ymaps.ready(init);
		var myMap;
		function init(){
				myMap = new ymaps.Map("map", {
				center: [49.15794957, 142.1032654], //Красноярск
				zoom: 15 }, {
        balloonMaxWidth: 200,
        searchControlProvider: 'yandex#search'
    });

    // Обработка события, возникающего при щелчке
    // левой кнопкой мыши в любой точке карты.
    // При возникновении такого события откроем балун.

    myMap.events.add('click', function (e) {
        if (!myMap.balloon.isOpen()) {
            var coords = e.get('coords');
            myMap.balloon.open(coords, {
                contentHeader:'Событие!',
                contentBody:'<p>Точка на карте</p>' +
                    '<p>Координаты:</p> ' + [
                    coords[0].toPrecision(10),
                    coords[1].toPrecision(10)
                    ].join(', ') + '</p>' + '<br><button>загрузить фото</button>' + '<br> <button> сохранить</button>' + '<input />',
                contentFooter:'<sup>Щелкните еще раз</sup>'
            });
        }
        else {
            myMap.balloon.close();
        }
    });
	
    // Обработка события, возникающего при щелчке
    // правой кнопки мыши в любой точке карты.
    // При возникновении такого события покажем всплывающую подсказку
    // в точке щелчка.
    myMap.events.add('contextmenu', function (e) {
        myMap.hint.open(e.get('coords'), 'Кто-то щелкнул правой кнопкой');
    });
    
    // Скрываем хинт при открытии балуна.
    myMap.events.add('balloonopen', function (e) {
        myMap.hint.close();
    });


        HintLayout = ymaps.templateLayoutFactory.createClass( "<div class='my-hint'>" +
            "<b>{{ properties.object }}</b><br />" +
            "{{ properties.address }}" +
            "</div>", {
                // Определяем метод getShape, который
                // будет возвращать размеры макета хинта.
                // Это необходимо для того, чтобы хинт автоматически
                // сдвигал позицию при выходе за пределы карты.
                getShape: function () {
                    var el = this.getElement(),
                        result = null;
                    if (el) {
                        var firstChild = el.firstChild;
                        result = new ymaps.shape.Rectangle(
                            new ymaps.geometry.pixel.Rectangle([
                                [0, 0],
                                [firstChild.offsetWidth, firstChild.offsetHeight]
                            ])
                        );
                    }
                    return result;
                }
            }
        );

    var myPlacemark1 = new ymaps.Placemark([49.16036043, 142.0948540], {
        address: "Сбер"
    }, {
        hintLayout: HintLayout
    });

    var myPlacemark2 = new ymaps.Placemark([49.15969165, 142.0974021], {
        address: "Школа"
    }, {
        hintLayout: HintLayout
    });

    myMap.geoObjects.add(myPlacemark1);
    myMap.geoObjects.add(myPlacemark2);


{% for i in data %}

var json{{i.id}} = new ymaps.Placemark([{{i.cord_x}}, {{i.cord_y}}], {
        address: "{{i.description}}"
    }, {
        hintLayout: HintLayout
    });

    myMap.geoObjects.add(json{{i.id}});
   
    // }

{% endfor %}



    




}






// }
	









	</script>
</head>

<body>

    <div class="container">
        <div class="row">
            
                <div id="map" style="width: 100%; height: 100%"></div>
            
        </div>
    </div>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

</body>
</html>